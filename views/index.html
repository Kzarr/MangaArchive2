<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>MangaArchive</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    body {
      font-family: sans-serif;
      background: #222;
      color: #fff;
      padding: 20px;
    }
    .manga {
      background: #333;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    .manga h2 {
      margin: 0 0 10px 0;
    }
    .chapter-list a {
      display: block;
      padding: 5px;
      color: #88f;
      text-decoration: none;
    }
    .chapter-list a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>MangaArchive</h1>
  <div id="mangaList"></div>

  <script>
    async function loadMangas() {
      const mangaRes = await fetch('/api/mangas');
      const chapterRes = await fetch('/chapters.json');
      const mangas = await mangaRes.json();
      const chapters = await chapterRes.json();

      const container = document.getElementById('mangaList');
      mangas.forEach(manga => {
        const div = document.createElement('div');
        div.classList.add('manga');

        const title = document.createElement('h2');
        title.textContent = manga.title;
        div.appendChild(title);

        const desc = document.createElement('p');
        desc.textContent = manga.description || '';
        div.appendChild(desc);

        const list = document.createElement('div');
        list.classList.add('chapter-list');

        const mangaChapters = chapters
          .filter(c => c.mangaId === manga.id)
          .sort((a, b) => a.number - b.number);

        mangaChapters.forEach(ch => {
          const link = document.createElement('a');
          link.href = `/manga/${manga.slug}/${ch.number}`;
          link.textContent = `Capítulo ${ch.number} — ${ch.title}`;
          list.appendChild(link);
        });

        div.appendChild(list);
        container.appendChild(div);
      });
    }

    loadMangas().catch(err => {
      document.body.innerHTML = '<p>Erro ao carregar mangás.</p>';
      console.error(err);
    });
  </script>
</body>
</html>
